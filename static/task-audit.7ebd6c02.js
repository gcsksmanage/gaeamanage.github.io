import{T as V,U as z,d as B,V as D,W as Z,r as C,q as F,S as J,X as I,Y as Q,Z as Y,$ as ee,a0 as te,a1 as ae,a2 as le,e as A,o as T,c as P,f as i,w as d,b as L,g as y,y as S,u as p,I as ne,J as oe,x as $,E as O,h as E,L as re,K as se,j as ie,m as ce,l as M,n as ue,_ as de,s as pe,v as fe,z as me,a3 as ge,M as ve,A as _e,B as he,C as be,D as U,F as ye,G as xe,H as we}from"./entry.9d5115e6.js";import{_ as ke}from"./client-only.04d65ef3.js";/* empty css                  *//* empty css                 *//* empty css               *//* empty css                     *//* empty css                *//* empty css                  *//* empty css                   *//* empty css                       */import{v as H,x as Ce}from"./adminManage.36b03f71.js";import{t as Te}from"./throttle.46d02480.js";/* empty css                 *//* empty css                   */import"./el-tooltip.4ed993c7.js";/* empty css                      *//* empty css                   */import{s as Ee}from"./index.ee23882a.js";/* empty css                */import"./request.c6e6787c.js";const N=globalThis.requestIdleCallback||(n=>{const t=Date.now(),g={didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-t))};return setTimeout(()=>{n(g)},1)}),Re=globalThis.cancelIdleCallback||(n=>{clearTimeout(n)}),Se=n=>{const t=V();t.isHydrating?t.hooks.hookOnce("app:suspense:resolve",()=>{N(n)}):N(n)};async function K(n,t=z()){const{path:g,matched:e}=t.resolve(n);if(!e.length||(t._routePreloaded||(t._routePreloaded=new Set),t._routePreloaded.has(g)))return;const s=t._preloadPromises=t._preloadPromises||[];if(s.length>4)return Promise.all(s).then(()=>K(n,t));t._routePreloaded.add(g);const u=e.map(a=>{var v;return(v=a.components)==null?void 0:v.default}).filter(a=>typeof a=="function");for(const a of u){const v=Promise.resolve(a()).catch(()=>{}).finally(()=>s.splice(s.indexOf(v)));s.push(v)}await Promise.all(s)}const Le=(...n)=>n.find(t=>t!==void 0),Ae="noopener noreferrer";/*! @__NO_SIDE_EFFECTS__ */function Pe(n){const t=n.componentName||"NuxtLink",g=(e,s)=>{if(!e||n.trailingSlash!=="append"&&n.trailingSlash!=="remove")return e;const u=n.trailingSlash==="append"?te:ae;if(typeof e=="string")return u(e,!0);const a="path"in e?e.path:s(e).path;return{...e,name:void 0,path:u(a,!0)}};return B({name:t,props:{to:{type:[String,Object],default:void 0,required:!1},href:{type:[String,Object],default:void 0,required:!1},target:{type:String,default:void 0,required:!1},rel:{type:String,default:void 0,required:!1},noRel:{type:Boolean,default:void 0,required:!1},prefetch:{type:Boolean,default:void 0,required:!1},noPrefetch:{type:Boolean,default:void 0,required:!1},activeClass:{type:String,default:void 0,required:!1},exactActiveClass:{type:String,default:void 0,required:!1},prefetchedClass:{type:String,default:void 0,required:!1},replace:{type:Boolean,default:void 0,required:!1},ariaCurrentValue:{type:String,default:void 0,required:!1},external:{type:Boolean,default:void 0,required:!1},custom:{type:Boolean,default:void 0,required:!1}},setup(e,{slots:s}){const u=z(),a=D(()=>{const r=e.to||e.href||"";return g(r,u.resolve)}),v=D(()=>e.external||e.target&&e.target!=="_self"?!0:typeof a.value=="object"?!1:a.value===""||Z(a.value,{acceptRelative:!0})),x=C(!1),_=C(null),w=r=>{var f;_.value=e.custom?(f=r==null?void 0:r.$el)==null?void 0:f.nextElementSibling:r==null?void 0:r.$el};if(e.prefetch!==!1&&e.noPrefetch!==!0&&e.target!=="_blank"&&!je()){const f=V();let o,l=null;F(()=>{const m=Be();Se(()=>{o=N(()=>{var b;(b=_==null?void 0:_.value)!=null&&b.tagName&&(l=m.observe(_.value,async()=>{l==null||l(),l=null;const h=typeof a.value=="string"?a.value:u.resolve(a.value).fullPath;await Promise.all([f.hooks.callHook("link:prefetch",h).catch(()=>{}),!v.value&&K(a.value,u).catch(()=>{})]),x.value=!0}))})})}),J(()=>{o&&Re(o),l==null||l(),l=null})}return()=>{var m,b;if(!v.value){const h={ref:w,to:a.value,activeClass:e.activeClass||n.activeClass,exactActiveClass:e.exactActiveClass||n.exactActiveClass,replace:e.replace,ariaCurrentValue:e.ariaCurrentValue,custom:e.custom};return e.custom||(x.value&&(h.class=e.prefetchedClass||n.prefetchedClass),h.rel=e.rel),I(Q("RouterLink"),h,s.default)}const r=typeof a.value=="object"?((m=u.resolve(a.value))==null?void 0:m.href)??null:a.value||null,f=e.target||null,o=e.noRel?null:Le(e.rel,n.externalRelAttribute,r?Ae:"")||null,l=()=>le(r,{replace:e.replace});return e.custom?s.default?s.default({href:r,navigate:l,get route(){if(!r)return;const h=Y(r);return{path:h.pathname,fullPath:h.pathname,get query(){return ee(h.search)},hash:h.hash,params:{},name:void 0,matched:[],redirectedFrom:void 0,meta:{},href:r}},rel:o,target:f,isExternal:v.value,isActive:!1,isExactActive:!1}):null:I("a",{ref:_,href:r,rel:o,target:f},(b=s.default)==null?void 0:b.call(s))}}})}const $e=Pe({componentName:"NuxtLink"});function Be(){const n=V();if(n._observer)return n._observer;let t=null;const g=new Map,e=(u,a)=>(t||(t=new IntersectionObserver(v=>{for(const x of v){const _=g.get(x.target);(x.isIntersecting||x.intersectionRatio>0)&&_&&_()}})),g.set(u,a),t.observe(u),()=>{g.delete(u),t.unobserve(u),g.size===0&&(t.disconnect(),t=null)});return n._observer={observe:e}}function je(){const n=navigator.connection;return!!(n&&(n.saveData||/2g/.test(n.effectiveType)))}const qe={class:"text-[#ebebeb] text-[16px] mb-5"},Ne={class:"text-red-500"},Ve={class:"w-full flex justify-end mt-5"},De=B({__name:"Reject",props:{dialogVisible:{type:Boolean,default:!1},item:{default:""}},emits:["update:closeDialog","update:success"],setup(n,{emit:t}){const g=n,e=C(),s=C(!1),u=C([{value:"Repetitive or overly similar content"},{value:"Low view count"},{value:"Contains prohibited content (e.g., ads, sensitive information, etc.)"},{value:"Fails to reflect GAEA-related topics or value"},{value:"Invalid or missing images/links"},{value:"The uploaded Discord account does not match the one that is linked."},{value:"Empty text or uploaded file is blank"},{value:"Incomplete task submission"},{value:"Use of auto-generated or non-original content"},{value:"Unclear or vague language expression"}]),a=A({reason:""}),v=r=>/^[A-Za-z\s.,'"()!@#$%^&*_\-/]+$/.test(r)&&r.length<=128,x=A({reason:[{required:!0,message:"驳回原因为必填项",trigger:"change"},{validator:(r,f,o)=>{f&&!v(f)?o(new Error("仅限英文内容，且长度不得超过128字符")):o()},trigger:"blur"}]}),_=()=>{t("update:closeDialog")},w=async r=>{r&&await r.validate(async(f,o)=>{f&&O.confirm(`驳回用户名为：${g.item.username} 的申请`,"Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{try{s.value=!0;const l=await H({id:g.item.id,status:-2,reason:a.reason});l.code===200?(E.success(l.data),t("update:success"),_()):E.error(l.msg)}catch{}finally{s.value=!1}}).catch(()=>{E({type:"info",message:"canceled"})})})};return(r,f)=>{const o=re,l=se,m=ie,b=ce,h=M,j=ue,R=ke;return T(),P("div",null,[i(R,null,{default:d(()=>[i(j,{draggable:"","model-value":r.$props.dialogVisible,style:{"background-color":"black",border:"1px  #ebebeb solid","border-radius":"10px","padding-bottom":"30px"},title:"",width:"550px",class:"px-10","align-center":"",onClose:_},{default:d(()=>[L("p",qe,[y("驳回用户名为："),L("span",Ne,S(g.item.username),1),y(" 的申请")]),i(b,{ref_key:"ruleFormRef",ref:e,class:"w-full p-5",inline:!0,"label-position":"right","label-width":"70px",model:p(a),rules:p(x)},{default:d(()=>[i(m,{label:"数量:",prop:"reason",class:"w-full"},{default:d(()=>[i(l,{modelValue:p(a).reason,"onUpdate:modelValue":f[0]||(f[0]=k=>p(a).reason=k),clearable:"",filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:"请选择驳回原因",style:{height:"32px","border-radius":"50px",width:"250px"}},{default:d(()=>[(T(!0),P(ne,null,oe(p(u),(k,q)=>(T(),$(o,{key:k.value,label:`${q+1}.${k.value}`,value:k.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),L("div",Ve,[i(h,{class:"w-[20%]",type:"info",onClick:f[1]||(f[1]=k=>_())},{default:d(()=>[y(" 取消 ")]),_:1}),i(h,{loading:p(s),class:"w-[20%]",type:"danger",onClick:f[2]||(f[2]=k=>("throttle"in r?r.throttle:p(Te))(()=>{w(p(e))}))},{default:d(()=>[y(" 驳回 ")]),_:1},8,["loading"])])]),_:1},8,["model-value"])]),_:1})])}}});const Ie=de(De,[["__scopeId","data-v-2b61c366"]]),Ue={class:"w-full h-full flex flex-col space-y-2 p-6"},ze={class:"w-full flex-1 overflow-y-auto"},Fe={class:"flex justify-end"},Oe=B({__name:"Index",props:{level:{default:""}},setup(n){const t=n,g=C(),e=C(!1),s=C(!1),u=A({content:[],totalElements:0}),a=A({level:Number(t.level),page:1,limit:20}),v=o=>{a.page=o,w()},x=o=>{a.limit=o,w()},_=o=>{const b=new URL(o).pathname.split("_");return b[b.length-1]},w=async()=>{try{s.value=!0;const o={...a},l=await Ce(o);s.value=!1,l.code&&(u.content=l.data.map(m=>({...m,passThroughLoading:!1,rejectLoading:!1})))}catch{s.value=!1}finally{s.value=!1}},r=o=>{O.confirm(`通过用户名为：${o.username} 的申请`,"Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{try{o.passThroughLoading=!0;const l=await H({id:o.id,status:2,reason:""});o.passThroughLoading=!1,l.code===200?(E.success(l.data),w()):E.error(l.msg)}catch{}finally{o.passThroughLoading=!1}}).catch(()=>{E({type:"info",message:"canceled"})})},f=o=>{g.value=o,e.value=!0};return F(async()=>{await pe(),w()}),(o,l)=>{const m=me,b=ge,h=$e,j=ve,R=M,k=_e,q=he,W=Ie,X=be;return T(),P("div",Ue,[L("div",ze,[fe((T(),$(k,{ref:"multipleTableRef",height:"600px",data:p(u).content,border:"",style:{height:"100%"},"header-cell-style":{background:"#e0eeee"}},{default:d(()=>[i(m,{prop:"userid",label:"用户ID",align:"center",width:"140px",sortable:""}),i(m,{prop:"username",label:"用户名",align:"center",width:"150px","show-overflow-tooltip":"",sortable:""}),i(m,{prop:"created_time",label:"上传时间",align:"center",width:"150px",sortable:"","show-overflow-tooltip":""}),i(m,{prop:"type",label:"勋章",align:"center",sortable:""},{default:d(c=>[i(b,{type:c.row.type===1?"success":c.row.type===2?"warning":"danger",size:"small",effect:"dark"},{default:d(()=>[y(S(c.row.type===1?"一级":c.row.type===2?"二级":"三级"),1)]),_:2},1032,["type"])]),_:1}),i(m,{prop:"medal_id",label:"任务id",align:"center","min-width":"100px",sortable:""}),i(m,{prop:"code",label:"任务代号",align:"center","min-width":"120px",sortable:""}),i(m,{prop:"social_x_name",label:"社交X名称",align:"center","min-width":"130px","show-overflow-tooltip":""},{default:d(c=>[y(S(c.row.social_x_name||"未绑定"),1)]),_:1}),i(m,{prop:"social_dc_name",label:"Discord名称",align:"center","min-width":"140px","show-overflow-tooltip":""},{default:d(c=>[y(S(c.row.social_dc_name||"未绑定"),1)]),_:1}),i(m,{prop:"url",label:"文件",align:"center",width:"150","show-overflow-tooltip":""},{default:d(c=>[i(j,{class:"box-item",title:"",content:`${_(c.row.url)}`,placement:"top-start"},{reference:d(()=>[i(h,{to:c.row.url,target:"_blank",rel:"noopener",class:"hover:underline underline-offset-4 u-line-1"},{default:d(()=>[y(S(("stringStar"in o?o.stringStar:p(Ee))({value:_(c.row.url),characters:"***",start:4,end:7})),1)]),_:2},1032,["to"])]),_:2},1032,["content"])]),_:1}),i(m,{label:"操作",width:"320",fixed:"right",align:"center"},{default:d(c=>[i(h,{to:c.row.url,target:"_blank",rel:"noopener",class:"mr-3"},{default:d(()=>[i(R,{type:"primary"},{default:d(()=>[y("查看")]),_:1})]),_:2},1032,["to"]),i(R,{type:"success",loading:c.row.passThroughLoading,onClick:G=>r(c.row)},{default:d(()=>[y("通过")]),_:2},1032,["loading","onClick"]),i(R,{type:"danger",loading:c.row.rejectLoading,onClick:G=>f(c.row)},{default:d(()=>[y("驳回")]),_:2},1032,["loading","onClick"])]),_:1})]),_:1},8,["data"])),[[X,p(s)]]),L("div",Fe,[i(q,{"current-page":p(a).page,"onUpdate:currentPage":l[0]||(l[0]=c=>p(a).page=c),"page-size":p(a).limit,"onUpdate:pageSize":l[1]||(l[1]=c=>p(a).limit=c),"page-sizes":[20,50,100,500,1e3],layout:"total, sizes, prev, pager, next, jumper",total:p(u).totalElements,onCurrentChange:v,onSizeChange:x},null,8,["current-page","page-size","total"])])]),i(W,{"dialog-visible":p(e),"onUpdate:closeDialog":l[2]||(l[2]=c=>e.value=!1),item:p(g),"onUpdate:success":l[3]||(l[3]=c=>w())},null,8,["dialog-visible","item"])])}}}),Me={class:"w-full h-full flex flex-col space-y-2 p-6"},dt=B({__name:"task-audit",setup(n){const t=C("2");return(g,e)=>{const s=Oe,u=xe,a=we;return T(),P("div",Me,[i(a,{modelValue:p(t),"onUpdate:modelValue":e[0]||(e[0]=v=>ye(t)?t.value=v:null),class:"w-full h-full bg-black"},{default:d(()=>[i(u,{label:"等级2",name:"2"},{default:d(()=>[p(t)=="2"?(T(),$(s,{key:0,level:p(t)},null,8,["level"])):U("",!0)]),_:1}),i(u,{label:"等级3",name:"3"},{default:d(()=>[p(t)=="3"?(T(),$(s,{key:0,level:p(t)},null,8,["level"])):U("",!0)]),_:1})]),_:1},8,["modelValue"])])}}});export{dt as default};
